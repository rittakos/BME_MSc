function result = noise(Q, OTF, DQE, Nx, Ny, dx, dy, I)

OTFSize= size(OTF);

Qperdetector = Q / (dx * dy);
Area = Nx * Ny * dx * dy;
MTF = abs(OTF);

NEQ = DQE * Qperdetector;
NNPS = (MTF .* MTF) ./ NEQ;

A = Q / Area;
NPS = NNPS * (A * A);

D = sqrt(NPS);
distribution = randn(OTFSize(1), OTFSize(2));
spectrum = D .* fft2(distribution);
result = ifft2(spectrum);

end

